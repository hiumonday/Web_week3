(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const u="https://jsonplaceholder.typicode.com/users",f=async()=>{try{const e=await fetch(u);if(!e.ok)throw new Error("Failed to fetch users");return await e.json()}catch(e){throw console.error("Error fetching users:",e),e}},p=async e=>{try{const t=await fetch(u,{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}});if(!t.ok)throw new Error("Failed to create user");return await t.json()}catch(t){throw console.error("Error creating user:",t),t}},y=async(e,t)=>{try{const n=await fetch(`${u}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}});if(!n.ok)throw new Error("Failed to update user");return await n.json()}catch(n){throw console.error("Error updating user:",n),n}},w=async e=>{try{if(!(await fetch(`${u}/${e}`,{method:"DELETE"})).ok)throw new Error("Failed to delete user");return!0}catch(t){throw console.error("Error deleting user:",t),t}};let s={users:[],filteredUsers:[],currentPage:1,itemsPerPage:5,searchQuery:"",isLoading:!1,editingUserId:null};const r={usersTable:document.getElementById("users-table"),usersTbody:document.getElementById("users-tbody"),loadingSpinner:document.getElementById("loading-spinner"),emptyState:document.getElementById("empty-state"),searchInput:document.getElementById("search-input"),prevPageBtn:document.getElementById("prev-page-btn"),nextPageBtn:document.getElementById("next-page-btn"),pageInfo:document.getElementById("page-info"),addUserBtn:document.getElementById("add-user-btn"),userModal:document.getElementById("user-modal"),closeModalBtn:document.getElementById("close-modal-btn"),cancelBtn:document.getElementById("cancel-btn"),userForm:document.getElementById("user-form"),modalTitle:document.getElementById("modal-title"),toast:document.getElementById("toast"),toastMessage:document.getElementById("toast-message")},l=(e,t="success")=>{r.toastMessage.textContent=e,r.toast.className=`toast show ${t}`,setTimeout(()=>{r.toast.className="toast hidden"},3e3)},d=(e=!0)=>{e?(r.userModal.classList.remove("hidden"),setTimeout(()=>r.userModal.classList.add("active"),10)):(r.userModal.classList.remove("active"),setTimeout(()=>r.userModal.classList.add("hidden"),300))},h=e=>{s.isLoading=e,e?(r.loadingSpinner.classList.remove("hidden"),r.usersTbody.innerHTML="",r.emptyState.classList.add("hidden")):r.loadingSpinner.classList.add("hidden")},c=()=>{if(r.usersTbody.innerHTML="",s.isLoading)return;const e=(s.currentPage-1)*s.itemsPerPage,t=e+s.itemsPerPage,n=s.filteredUsers.slice(e,t);if(n.length===0){r.emptyState.classList.remove("hidden");return}else r.emptyState.classList.add("hidden");n.forEach(a=>{const o=document.createElement("tr");o.innerHTML=`
      <td>#${a.id}</td>
      <td>${a.name}</td>
      <td>${a.email}</td>
      <td>${a.phone}</td>
      <td class="actions-cell">
        <button class="btn-icon edit" data-id="${a.id}" title="Edit">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
        </button>
        <button class="btn-icon delete" data-id="${a.id}" title="Delete">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
        </button>
      </td>
    `,r.usersTbody.appendChild(o)}),E()},E=()=>{const e=Math.ceil(s.filteredUsers.length/s.itemsPerPage);r.pageInfo.textContent=`Page ${s.currentPage} of ${e||1}`,r.prevPageBtn.disabled=s.currentPage===1,r.nextPageBtn.disabled=s.currentPage===e||e===0},g=()=>{const e=s.searchQuery.toLowerCase();s.filteredUsers=s.users.filter(t=>t.name.toLowerCase().includes(e)),s.currentPage=1,c()},v=e=>{const t=s.users.find(n=>n.id===e);t&&(s.editingUserId=e,r.modalTitle.textContent="Edit User",r.userForm.name.value=t.name,r.userForm.email.value=t.email,r.userForm.phone.value=t.phone,d(!0))},L=async e=>{if(confirm("Are you sure you want to delete this user?"))try{await w(e),s.users=s.users.filter(t=>t.id!==e),g(),l("User deleted successfully")}catch{l("Failed to delete user","error")}},P=()=>{r.searchInput.addEventListener("input",e=>{s.searchQuery=e.target.value,g()}),r.prevPageBtn.addEventListener("click",()=>{s.currentPage>1&&(s.currentPage--,c())}),r.nextPageBtn.addEventListener("click",()=>{const e=Math.ceil(s.filteredUsers.length/s.itemsPerPage);s.currentPage<e&&(s.currentPage++,c())}),r.addUserBtn.addEventListener("click",()=>{s.editingUserId=null,r.modalTitle.textContent="Add New User",r.userForm.reset(),d(!0)}),r.closeModalBtn.addEventListener("click",()=>d(!1)),r.cancelBtn.addEventListener("click",()=>d(!1)),r.userModal.addEventListener("click",e=>{(e.target===r.userModal||e.target.classList.contains("modal-overlay"))&&d(!1)}),r.userForm.addEventListener("submit",async e=>{e.preventDefault();const t={name:r.userForm.name.value,email:r.userForm.email.value,phone:r.userForm.phone.value};try{if(s.editingUserId){const n=await y(s.editingUserId,t);s.users=s.users.map(a=>a.id===s.editingUserId?{...a,...t}:a),l("User updated successfully")}else{const n=await p(t);n.id=s.users.length>0?Math.max(...s.users.map(a=>a.id))+1:1,s.users.unshift(n),l("User created successfully")}d(!1),g()}catch{l("Operation failed","error")}}),r.usersTbody.addEventListener("click",e=>{const t=e.target.closest("button");if(!t)return;const n=parseInt(t.dataset.id);t.classList.contains("edit")?v(n):t.classList.contains("delete")&&L(n)})},B=async()=>{P(),h(!0);try{const e=await f();s.users=e,s.filteredUsers=e}catch{l("Failed to load users","error")}finally{h(!1),c()}};B();
